swagger: '2.0'
info:
  title: Deep Space API
  version: 1.0.0
basePath: https://client.deepspacesync.com/api/v1/
schemes:
- https
securityDefinitions:
  JWT:
    authorizationUrl: ''
    flow: implicit
    type: oauth2
paths:
  /login:
    post:
      summary: Login to get JWT token
      description: Validates Deep Space username and password and returns JWT token
        for API
      operationId: login
      tags:
      - Authentication
      parameters:
      - name: username
        in: header
        required: true
        type: string
      - name: password
        in: header
        required: true
        type: string
      - name: region
        in: header
        required: true
        type: string
      responses:
        200:
          description: JWT
          schema:
            type: string
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/logout/{userId}:
    post:
      summary: Logout a user for a certain project
      description: Used to track logout times, mainly for concurrent seat licenses
      operationId: logoutUser
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: userId
        in: path
        required: true
        type: string
        description: email
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /regions:
    get:
      tags:
      - Info
      summary: Get supported regions
      description: Returns list of api-supported regions
      operationId: getRegions
      parameters:
      - in: query
        name: fields
        description: Comma-separated list of fields to include in the response
        required: false
        type: string
      responses:
        200:
          description: list of supported regions
  /workspaces:
    get:
      summary: Get list of workspaces and associated projects
      description: Returns all workspaces and projects a user has access to with optional
        parameters for extra info
      operationId: getWorkspaces
      tags:
      - Info
      parameters:
      - name: includeDetails
        description: Includes additional details in response
        in: query
        required: false
        type: boolean
      - name: includePermissions
        description: Includes permissions in response
        in: query
        required: false
        type: boolean
      security:
      - JWT: []
      responses:
        200:
          description: Successful response with a list of workspaces and projects
          schema:
            type: array
            items:
              type: object
              properties:
                workspace:
                  description: ds_workspace_name corresponding to dataset name
                  type: string
                  example: ds_12345678_9123_4567_8912_123456789123
                workspace_name:
                  type: string
                  example: My Workspace Name
                projects:
                  type: array
                  items:
                    type: object
                    properties:
                      project_id:
                        type: integer
                        example: 1
                      project_name:
                        type: string
                        example: My Project Name
        401:
          description: Unauthorized
        400:
          description: Bad Request due to invalid parameters
        204:
          description: No content to return
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/sourcefiles:
    get:
      summary: Get sourcefies by projectid
      description: Returns all sourcefiles details for a project
      operationId: getSourceFiles
      tags:
      - Files
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: A list of sourcefiles
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      summary: Create a sourcefile in a project
      description: Creates a new sourcefile in a project with provided filename and
        discipline
      operationId: postSourceFiles
      tags:
      - Files
      consumes:
      - application/json
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - filename
          - discipline
          properties:
            filename:
              type: string
              description: The name of the sourcefile
            discipline:
              type: string
              description: The discipline of the sourcefile
      security:
      - JWT: []
      responses:
        201:
          description: Sourcefile successfully created
          schema:
            description: idSourceFiles
            type: string
        401:
          description: Unauthorized
        409:
          description: Filename already exists
        400:
          description: Bad Request
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/data/any:
    post:
      summary: Upload any data to Deep Space
      description: Generic endpoint to upload csv data in any format to Deep Space
        in EAV format.
      operationId: uploadanydata
      tags:
      - Upload Data
      consumes:
      - multipart/form-data
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: file
        in: formData
        required: true
        type: string
        description: The CSV file to upload
      - name: data_classification
        in: formData
        required: true
        type: string
        description: The unique identifying name to categorise the data type
      security:
      - JWT: []
      responses:
        200:
          description: ingest_id of successfully loaded data
          schema:
            type: string
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/data:
    get:
      summary: Get list of data classifications
      operationId: getDataClassifications
      tags:
      - Upload Data
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: A list of supported data classifications
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/data/{data_classification}:
    get:
      summary: Get list of data sources
      operationId: getDataSources
      tags:
      - Upload Data
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: data_classification
        in: path
        required: true
        type: string
        description: The classification of the data
      security:
      - JWT: []
      responses:
        200:
          description: A list of supported data sources
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
        400:
          description: Bad Request
  /workspaces/{workspaceId}/projects/{projectId}/data/{data_classification}/{data_source}/{export_type}/{export_version}:
    post:
      summary: Upload data to Deep Space from supported formats
      operationId: uploaddata
      tags:
      - Upload Data
      consumes:
      - multipart/form-data
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: data_classification
        in: path
        required: true
        type: string
        description: The classification of the data
      - name: data_source
        in: path
        required: true
        type: string
        description: The source of the data
      - name: export_type
        in: path
        required: true
        type: string
        description: The type of export
      - name: export_version
        in: path
        required: true
        type: string
        description: The version of the export
      - name: file
        in: formData
        required: true
        type: string
        description: The file to upload
      security:
      - JWT: []
      responses:
        200:
          description: crawlId of successfully loaded data
          schema:
            type: string
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
        400:
          description: Bad Request
        422:
          description: Unprocessable Entity
  /workspaces/{workspaceId}/projects/{projectId}/parameters:
    get:
      summary: Get parameters for project
      description: Get list of unique parameters from all parameter sets for a project
      operationId: getParameters
      tags:
      - Navis Integration
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: A list of parameters
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/milestone:
    get:
      tags:
      - Configuration
      summary: Get list of current milestones
      operationId: getMilestones
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: A list of current milestones
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      tags:
      - Configuration
      summary: Create new milestone
      operationId: postMilestone
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - milestone_name
          - milestone_data
          properties:
            filename:
              type: string
              description: The name of the milestone
            discipline:
              type: string
              description: The date of the milestone, expected format 'yyyy-mm-dd'
      security:
      - JWT: []
      responses:
        201:
          description: Successfully created new milestone
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/actions:
    post:
      tags:
      - Actions
      summary: Create new action
      operationId: createAction
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - actionType
          - name
          properties:
            actionType:
              type: string
              description: The type of action - "Task", "RFI", "Risk", "Opportunity",
                "Lesson Learnt"
            name:
              type: string
              description: Name of the action
            description:
              type: string
              description: Description of the action
            dueDate:
              type: string
              description: Due date of the action, expected format 'yyyy-mm-dd'
            rating:
              type: string
              description: Rating of the action - "Low", "Medium", "High"
            currentApp:
              type: string
              description: App that the action was created from
      security:
      - JWT: []
      responses:
        200:
          description: Successfully created new action
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    patch:
      tags:
      - Actions
      summary: Update fields in existing action
      operationId: updateAction
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - action_id
          properties:
            action_id:
              type: integer
              description: id of existing action to update
      security:
      - JWT: []
      responses:
        200:
          description: Successfully updated action
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    get:
      tags:
      - Actions
      summary: Get actions
      operationId: getActions
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: currentApp
        in: query
        required: false
        type: string
      security:
      - JWT: []
      responses:
        200:
          description: Successfully created new action
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/cde:
    post:
      tags:
      - Upload Data
      summary: Get signed urls for cde
      operationId: getCde
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: Successfully returns CDE urls
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/teams:
    get:
      tags:
      - Teams
      summary: Get list of teams
      operationId: getTeams
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: includeDetails
        in: query
        required: false
        type: boolean
      security:
      - JWT: []
      responses:
        200:
          description: list of teams
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      tags:
      - Teams
      summary: Create a new team
      operationId: postTeam
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - discipline
          - pri_abbrev
          - company_id
          properties:
            discipline:
              type: string
              description: The name of the team
            pri_abbrev:
              type: string
              description: The abbreviation of the team
            company_id:
              type: integer
              description: The company id of the team (see GET /companies)
      security:
      - JWT: []
      responses:
        200:
          description: new team created
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/teams/{teamId}:
    patch:
      tags:
      - Teams
      summary: Edit a team
      operationId: patchTeam
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: teamId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            discipline:
              type: string
              description: The name of the team
            pri_abbrev:
              type: string
              description: The abbreviation of the team
            company_id:
              type: integer
              description: The company id of the team (see GET /companies)
      security:
      - JWT: []
      responses:
        200:
          description: team edited
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/jobs/{job_id}:
    post:
      tags:
      - Jobs
      summary: Start a new job
      operationId: startJob
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: job_id
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        202:
          description: Job started, returns job guid
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/jobs:
    get:
      tags:
      - Jobs
      summary: Get supported jobs
      operationId: getJobs
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: app
        description: Get jobs associated with a specific app
        in: query
        required: false
        type: string
      security:
      - JWT: []
      responses:
        202:
          description: Job started, returns job guid
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/jobs/{job_guid}/status:
    get:
      tags:
      - Jobs
      summary: Get job status
      operationId: getJobStatus
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: job_guid
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        202:
          description: Returns job status
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects:
    get:
      summary: Get projects in a workspace
      operationId: getProjects
      tags:
      - Info
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      security:
      - JWT: []
      responses:
        200:
          description: Project details
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}:
    delete:
      summary: Archive a project
      operationId: archiveProject
      tags:
      - Delete
      consumes:
      - application/json
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: string
      security:
      - JWT: []
      responses:
        201:
          description: Project successfully archived
        401:
          description: Insufficent permissions to archive project
        400:
          description: Bad Request
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/users:
    get:
      summary: Get users in a project
      description: Returns all users and user details for a project
      operationId: getProjectUsers
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      summary: Invite user to a project
      description: Creates a user if not already exista and invites to project
      operationId: postProjectUsers
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - email
          - name
          - team_bim_id
          properties:
            email:
              type: string
              description: The email of the user
            name:
              type: string
              description: The name of the user like First Last
            team_bim_id:
              type: integer
              description: The team id to add the user to on the project
            isProjectManager:
              type: boolean
              description: bool indicating whether the user is a project manager (default
                false)
            isProjectViewer:
              type: boolean
              description: bool indicating whether the user is a project viewer (default
                false)
            isRevitUsers:
              type: boolean
              description: bool indicating whether the user is a revit user (default
                false)
            isWorkspaceManager:
              type: boolean
              description: bool indicating whether the user is a workspace manager
                (default false)
            isWorkspaceDashboardViewer:
              type: boolean
              description: bool indicating whether the user is a workspace viewer
                (default false)
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/projects/{projectId}/users/{userId}:
    get:
      summary: Get user in a project
      description: Returns user and details for specified project
      operationId: getProjectUser
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: projectId
        in: path
        required: true
        type: integer
      - name: userId
        in: path
        required: true
        type: string
      - name: outsetaToken
        in: query
        required: false
        type: string
        description: bool indicating whether to retrieve outseta token
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/users:
    get:
      summary: Get users in a workspaces
      description: Returns all users and user details for a workspace
      operationId: getWorkspaceUsers
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      summary: Invite user to a workspace
      description: Creates user if not already exista and invites to workspace
      operationId: postWorkspaceUsers
      tags:
      - Users
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - email
          - name
          properties:
            email:
              type: string
              description: The email of the user
            name:
              type: string
              description: The name of the user like First Last
            isWorkspaceManager:
              type: boolean
              description: bool indicating whether the user is a workspace manager
                (default false)
            isWorkspaceDashboardViewer:
              type: boolean
              description: bool indicating whether the user is a workspace viewer
                (default false)
            projects:
              type: array
              description: array of project to add the user to in workspace
              items:
                type: object
                required:
                - project_id
                - team_bim_id
                properties:
                  project_id:
                    type: integer
                    description: The project id to add the user to
                  team_bim_id:
                    type: integer
                    description: The team id to add the user to on the project
                  isProjectManager:
                    type: boolean
                    description: bool indicating whether the user is a project manager
                      (default false)
                  isProjectViewer:
                    type: boolean
                    description: bool indicating whether the user is a project viewer
                      (default false)
                  isRevitUser:
                    type: boolean
                    description: bool indicating whether the user is a revit user
                      (default false)
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/companies:
    get:
      summary: Get companies in a workspaces
      description: Returns all companies for a workspace
      operationId: getWorkspaceCompanies
      tags:
      - Companies
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
    post:
      summary: Create company in a workspaces
      description: Creates a new company in a workspace. Requires workspace manager
        permissions
      operationId: postWorkspaceCompanies
      tags:
      - Companies
      consumes:
      - application/json
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: body
        in: body
        required: true
        schema:
          type: object
          required:
          - company_name
          - company_abbreviation
          properties:
            company_name:
              type: string
              description: The name of the company
            company_abbreviation:
              type: string
              description: The abbreviation of the company name
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
  /workspaces/{workspaceId}/companies/{companyId}:
    patch:
      summary: Update a company
      operationId: patchWorkspaceCompanies
      tags:
      - Companies
      consumes:
      - application/json
      parameters:
      - name: workspaceId
        in: path
        required: true
        type: string
      - name: companyId
        in: path
        required: true
        type: integer
      - name: body
        in: body
        required: true
        schema:
          type: object
          properties:
            company_name:
              type: string
              description: The name of the company
            company_abbreviation:
              type: string
              description: The abbreviation of the company name
      security:
      - JWT: []
      responses:
        200:
          description: A successful response
        401:
          description: Unauthorized
        500:
          description: Internal Server Error
